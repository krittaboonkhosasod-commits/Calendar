<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Work Calendar (Text Login)</title>

<style>
:root{
    --work:#22c55e;
    --leave:#ef4444;
    --late:#f97316;
    --site:#2563eb;
    --off:#94a3b8;
}
*{box-sizing:border-box}
body{
    margin:0;
    min-height:100vh;
    font-family:"Segoe UI",system-ui;
    background:linear-gradient(135deg,#7dd3fc,#a78bfa,#60a5fa);
    display:flex;
    justify-content:center;
    align-items:center;
}

/* ===== LOGIN ===== */
#loginBox{
    background:#fff;
    padding:32px;
    border-radius:22px;
    box-shadow:0 20px 50px rgba(0,0,0,.35);
    text-align:center;
}
#loginBox input{
    width:220px;
    padding:10px;
    border-radius:14px;
    border:none;
    background:#f1f5f9;
    font-size:16px;
}
#loginBox button{
    margin-top:14px;
    padding:10px 24px;
    border:none;
    border-radius:20px;
    font-weight:800;
    cursor:pointer;
}

/* ===== APP ===== */
.app{
    width:95%;
    max-width:1350px;
    background:rgba(255,255,255,.35);
    backdrop-filter:blur(22px);
    border-radius:28px;
    padding:22px;
}

/* ===== HEADER ===== */
.header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:16px;
}
.header h1{
    margin:0;
    font-size:26px;
    font-weight:900;
}

/* ===== CONTROLS ===== */
.controls{
    display:flex;
    align-items:center;
    gap:12px;
}
.selectors{
    display:flex;
    gap:8px;
}
.controls select{
    padding:8px 14px;
    border-radius:18px;
    border:none;
    font-weight:700;
}
.logout{
    background:#ef4444;
    color:#fff;
    font-weight:800;
    padding:8px 20px;
    border:none;
    border-radius:20px;
    cursor:pointer;
    white-space:nowrap;
}
.logout:hover{opacity:.85}

/* ===== CALENDAR ===== */
.calendar{
    display:grid;
    grid-template-columns:repeat(7,1fr);
    gap:12px;
}
.day-name{
    text-align:center;
    font-weight:800;
    padding:8px;
    background:rgba(0,0,0,.35);
    color:#fff;
    border-radius:14px;
}
.day{
    background:#fff;
    border-radius:20px;
    padding:8px;
    min-height:170px;
    border-top:6px solid transparent;
}
.day.work{border-color:var(--work)}
.day.leave{border-color:var(--leave)}
.day.late{border-color:var(--late)}
.day.site{border-color:var(--site)}
.day.off{border-color:var(--off)}
.date{
    text-align:right;
    font-weight:900;
}

/* ===== INPUT ===== */
select,input,textarea{
    width:100%;
    margin-top:5px;
    padding:6px 8px;
    border:none;
    border-radius:12px;
    background:#f1f5f9;
    font-size:14px;
}
textarea{resize:none}

/* ===== MOBILE ===== */
@media (max-width:600px){
    body{align-items:flex-start;padding:10px}
    .header{flex-direction:column;gap:10px}
    .controls{
        width:100%;
        justify-content:space-between;
    }
    .selectors{
        flex:1;
    }
    .selectors select{
        flex:1;
    }
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginBox">
    <h2>เข้าสู่ระบบ</h2>
    <input id="username" placeholder="ชื่อผู้ใช้งาน">
    <br>
    <button onclick="login()">เข้าใช้งาน</button>
</div>

<!-- APP -->
<div class="app" id="app" style="display:none">
    <div class="header">
        <h1 id="title"></h1>
        <div class="controls">
            <div class="selectors">
                <select id="month"></select>
                <select id="year"></select>
            </div>
            <button class="logout" onclick="logout()">Logout</button>
        </div>
    </div>

    <div class="calendar" id="calendar">
        <div class="day-name">อาทิตย์</div>
        <div class="day-name">จันทร์</div>
        <div class="day-name">อังคาร</div>
        <div class="day-name">พุธ</div>
        <div class="day-name">พฤหัส</div>
        <div class="day-name">ศุกร์</div>
        <div class="day-name">เสาร์</div>
    </div>
</div>

<script>
/* ===== LOGIN SYSTEM ===== */
let currentUser = localStorage.getItem("wc-user");

function login(){
    const u = username.value.trim();
    if(!u){ alert("กรุณาใส่ชื่อผู้ใช้งาน"); return; }
    currentUser = u;
    localStorage.setItem("wc-user", u);
    loginBox.style.display="none";
    app.style.display="block";
    render();
}
function logout(){
    localStorage.removeItem("wc-user");
    location.reload();
}
if(currentUser){
    loginBox.style.display="none";
    app.style.display="block";
}

/* ===== CALENDAR ===== */
const months=["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน",
              "กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"];

const cal=document.getElementById("calendar");
const title=document.getElementById("title");
const mSel=document.getElementById("month");
const ySel=document.getElementById("year");

months.forEach((m,i)=>mSel.add(new Option(m,i)));
for(let y=2024;y<=2035;y++) ySel.add(new Option(y,y));

const key=(y,m,d)=>`wc-${currentUser}-${y}-${m}-${d}`;
const load=k=>JSON.parse(localStorage.getItem(k)||"{}");
const save=(k,v)=>localStorage.setItem(k,JSON.stringify(v));

function render(){
    cal.querySelectorAll(".day").forEach(e=>e.remove());
    const m=+mSel.value,y=+ySel.value;
    title.textContent=`ปฏิทินการทำงาน – ${months[m]} ${y}`;

    const first=new Date(y,m,1).getDay();
    const days=new Date(y,m+1,0).getDate();
    let d=1;

    for(let i=0;i<42;i++){
        const cell=document.createElement("div");
        cell.className="day";

        if(i>=first && d<=days){
            const k=key(y,m,d);
            const data=load(k);

            cell.innerHTML=`
                <div class="date">${d}</div>
                <select>
                    <option value="">สถานะ</option>
                    <option value="work">ทำงาน</option>
                    <option value="leave">ลา</option>
                    <option value="late">มาสาย</option>
                    <option value="site">ออกไซต์</option>
                    <option value="off">หยุด</option>
                </select>
                <input type="time">
                <input type="time">
                <input placeholder="Site">
                <textarea placeholder="หมายเหตุ"></textarea>
            `;

            const els=cell.querySelectorAll("select,input,textarea");
            ["status","in","out","site","note"].forEach((f,i)=>{
                if(data[f]) els[i].value=data[f];
            });
            if(data.status) cell.classList.add(data.status);

            els.forEach(el=>{
                el.oninput=()=>{
                    save(k,{
                        status:els[0].value,
                        in:els[1].value,
                        out:els[2].value,
                        site:els[3].value,
                        note:els[4].value
                    });
                    cell.className="day "+(els[0].value||"");
                };
            });
            d++;
        }
        cal.appendChild(cell);
    }
}

mSel.onchange=render;
ySel.onchange=render;
render();
</script>

</body>
</html>
